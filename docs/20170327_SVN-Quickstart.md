今日から始める Subversion
そんなにころころ変わるものでもないけど 2017 年版。

## Subversion (SVN) とは

Git が流行る前に主流だったバージョン管理ツール。
もちろん現在もあらゆる現場で使われている。

Git との大きな違いはそのファイル管理方式だが、使い始める上では特に理解する必要はない。

| 名称       | ファイル管理方式 |
| ---------- | ---------------- |
| Subversion | 集中型           |
| Git        | 分散型           |

## 利用フロー

一般的なワークフローは本流の Trunk と作業用の Branch、リリース用の Tag を分離して利用するケースが多い。

![20170327-SVN.png](https://qiita-image-store.s3.amazonaws.com/0/167943/56caf0bd-4569-f0f3-c6ef-522551060597.png)

1. Trunk から Branch を作成
2. Branch でファイルを変更
3. 変更を Commit
4. (2-3 を繰り返し)
5. 開発が完了したら、Branch を Trunk に Merge
6. Trunk から Tag を作成
7. Tag からリリース

## 用語

太字の用語さえ理解していればなんとかなる。
それぞれの用語の和訳を理解していれば大抵想像がつくようになっている。

### 名称

| 名称       | 読み       | 直訳             | 説明                                                                                                                                                              |
| ---------- | ---------- | ---------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Repository | リポジトリ | [貯蔵所、倉庫]   | Trunk や Branch などすべてを包括するもの。                                                                                                                        |
| **Trunk**  | トランク   | [(木の)幹，樹幹] | そのプロジェクトの最新のソースが管理されるベース。**基本的に Trunk を直接変更してはならない。**                                                                   |
| **Branch** | ブランチ   | [(木の)枝]       | 開発を行う際に作成される作業ワーク。                                                                                                                              |
| Tag        | タグ       | [付け札]         | リリースバージョン。後で差し戻しなどを行えるよう、リリース時点の Trunk の状態を保存しておくためのもの。                                                           |
| Revision   | リビジョン | [改訂、修正]     | Commit を行った時点（セーブポイント）のこと。_r1234_ などと表記され、数値が増えていく。後からこの地点に戻したり、リビジョン同士で差分を出したりすることができる。 |

### 操作

| 操作名     | 読み           | 直訳       | 説明                                                                                                                        |
| ---------- | -------------- | ---------- | --------------------------------------------------------------------------------------------------------------------------- |
| **Commit** | コミット       | -          | 保存する・セーブポイントを作る。この操作を行うと Revision 番号が上がる。                                                    |
| **Merge**  | マージ         | [併合する] | SVN では大抵 Branch を Trunk に取り込むことを指す。分岐した枝(ブランチ)をひとつに戻すということ。                           |
| Revert     | リバート       | [戻す]     | 指定した Revision の状態に戻す。                                                                                            |
| Checkout   | チェックアウト | -          | Branch などをローカルに持ってくる、最初に行う操作。                                                                         |
| Export     | エクスポート   | -          | ソースをローカルなどにダウンロードする。Checkout と違う点は、コミット情報を持たない生のファイルのみを保存するというところ。 |

## SVN で開発を行う上でやってはならないこと

### 開発中 Branch がある状態で、Trunk に直接変更を行い Commit する。

Branch を Trunk にマージできなくなったりする。
解決法はあるが大抵面倒なことが発生するのでやらない方が良い。

## ツール

[TortoiseSVN](https://tortoisesvn.net/)
基本これを使ってチェックアウトやコミットなどを行う。 `Tortoise` はトータスと読む。

## もっと詳しく

- [バージョン管理システム入門(初心者向け)by tracpath](http://tracpath.com/bootcamp/learning_subversion_tutorial1.html)

## Tips

### マージ操作

Branch 開発中に Trunk が更新された場合に、開発 Branch に Trunk を取り込む場合はマージを使う。
（ここでは TortoiseSVN を使う前提で説明する）

まずはマージしたい Branch を選択して SVN メニューの `マージ(M)...` を選び、次のように進めていく。

| 項目                       | 値                       |
| -------------------------- | ------------------------ |
| マージタイプ               | リビジョンの範囲をマージ |
| マージ元の URL             | Trunk の URL             |
| マージするリビジョンの範囲 | すべてのリビジョン       |
| マージオプション           | お好みで                 |

ここでマージに問題が無ければすんなり通るが、コンフリクト(競合)が発生した場合は警告が出力される。コンフリクトが発生した場合には人間が手動でファイルの差分を確認しながら 1 行ごとにマージ作業をしなければならない。

この時 TortoiseSVN は、「Trunk のファイル」「Branch のファイル」「作業コピー」の三種類のファイルを自動生成する。最終的な目標は Trunk と Branch のファイルを正しくあるべき状態で保存し、それを作業コピーとしてコミットすることだ。

マージ作業には WinMerge などのツールがよく利用されるが、ともかく作業コピーにあるファイルの状態を正しいものに修正し終えたら、TortoiseSVN のメニューから対象ファイルを `競合の解決(O)...` から解決マークを付ければ競合の問題は解消されたことになる。

参考リンク: [TortoiseSVN/競合してコミット出来ない時には - tracpath.com](http://wiki.tracpath.com/TortoiseSVN/%E7%AB%B6%E5%90%88%E3%81%97%E3%81%A6%E3%82%B3%E3%83%9F%E3%83%83%E3%83%88%E5%87%BA%E6%9D%A5%E3%81%AA%E3%81%84%E6%99%82%E3%81%AB%E3%81%AF)

## その他の参考文献

- [Qiita: 今更聞けない Subversion の使い方](http://qiita.com/mountcedar/items/e756bb9136e3b1722bb2)
- [Qiita: 【svn】基本コマンド](http://qiita.com/konweb/items/6effd36aab551b2d6b8f)
